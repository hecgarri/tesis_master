
PAPER TITLE: "NONLINEARITIES IN THE US CORN-ETHANOL-OIL-GASOLINE PRICE SYSTEM"
AUTHOR CONTACT INFORMATION: TERESA SERRA (TERESA.SERRA-DEVESA@UPC.EDU)


TWO MAIN SOFTWARE PROGRAMS WERE USED TO DERIVE THE PAPER MAIN RESULTS: 
RATS V 6.3 (INCLUDING CATS IN RATS) AND SAS V.9

RATS WAS USED TO CARRY OUT UNIT ROOT TESTS AND ASSESS COINTEGRATION. 

TO TEST FOR UNIT ROOTS, WE USED THE FOLLOWING "CANNED" PROCEDURES FROM WWW.ESTIMA.COM:

- URADF.SRC
- KPSS.SRC
- PERRON97.SRC
- ERSTEST.SRC

THE CATS IN RATS "CANNED" PROCEDURE WAS USED TO STUDY COINTEGRATION AND CARRY OUT
THE TESTS CITED IN THE PAPER.

FINALLY, SAS WAS USED TO DERIVE THE ESTIMATES OF THE STVECM. 
THE SAS CODE IS OFFERED BELOW.


/*******************************************************************************************/

/*IMPORT FILE CONTAINING THE FOLLOWING DATA (THESE CAN BE PREPARED IN AN EXCEL FILE): 
- PRICE DATA, PRICES IN FIRST DIFFERENCES AND PRICE LAGS, 
- ERROR CORRECTION TERMS DERIVED FROM CATS IN RATS AND ERROR CORRECTION TERM LAGS
- THE VARIANCE OF THE ERROR CORRECTION TERMS (AS A CONSTANT)
- A DUMMY VARIABLE DEFINED AS IN THE PAPER
*/

/*WE CALL THE IMPORTED FILE ALL2*/


/*******************************************************************************************/


/******************************TESTING FOR THE STVECM LAG LENGTH****************************/


/*TO DETERMINE THE OPTIMAL LAG LENGTH WE ESTIMATE A LINEAR VECM*/


/*AN EXAMPLE OF THE CODE OF ONE OF THE SEVERAL ALTERNATIVE LINEAR MODELS ESTIMATED IS BELOW*/

PROC VARMAX DATA=ALL2; 
      MODEL ETHANOL CORN OIL GASOLINE = ECT4_1 ECT5_1/ 
P=5 DIF=(ETHANOL(1) CORN(1) OIL(1) GASOLINE(1)) ; 

RUN;

/*NOTE: ECT4_1 REPRESENTS DISEQUILIBRIUM IN THE OIL REFINING INDUSTRY AND ECT5_1 IN THE ETHANOL
INDUSTY*/
/*PROC SYSLIN COULD ALSO BE USED TO ESTIMATE THE MODEL INSTEAD OF VARMAX*/



/*******************************************************************************************/


/******************TESTING FOR THE THRESHOLD VARIABLE AND FOR LINEARITY*********************/



DATA ALL2; SET ALL2; 


/* IN ORDER TO TEST FOR LINEARITY WE NEED TO MULTIPLY ALL EXPLANATORY VARIABLES BY 
THE DIFFERENT POSSIBLE TRANSITION VARIABLES. SINCE WE ARE ESTIMATING A STVECM, WE WILL
TRY DIFFERENT LAG LENGTHS FOR THE ERROR CORRECTION TERM ECT5 (REPRESENTING DISEQUILIBRIUM
IN THE ETHANOL INDUSTRY)*/

/*BELOW WE OFFER THE CODE OF ONE OF THE POSSIBLE SPECIFICATIONS THAT WERE CONSIDERED*/



/*MULTIPLYING ALL EXPLANATORY VARIABLES BY THE TRANSITION VARIABLE - ECT5_1*/

SECT4_1 	= ECT4_1	*ECT5_1;
SSECT4_1 	= ECT4_1	*ECT5_1*ECT5_1;

SECT5_1 	= ECT5_1	*ECT5_1;
SSECT5_1 	= ECT5_1	*ECT5_1*ECT5_1;


/*LAGS CORN*/
SDCORN_1 = LAG(DCORN)*ECT5_1;
SDCORN_2 = LAG2(DCORN)*ECT5_1;
SDCORN_3 = LAG3(DCORN)*ECT5_1;


/*LAGS ETHANOL*/
SDETHANOL_1 = LAG(DETHANOL)*ECT5_1;
SDETHANOL_2 = LAG2(DETHANOL)*ECT5_1;
SDETHANOL_3 = LAG3(DETHANOL)*ECT5_1;


/*LAGS OIL*/
SDOIL_1 = LAG(DOIL)*ECT5_1;
SDOIL_2 = LAG2(DOIL)*ECT5_1;
SDOIL_3 = LAG3(DOIL)*ECT5_1;


/*LAGS GASOLINE*/
SDGASOLINE_1 = LAG(DGASOLINE)*ECT5_1;
SDGASOLINE_2 = LAG2(DGASOLINE)*ECT5_1;
SDGASOLINE_3 = LAG3(DGASOLINE)*ECT5_1;


/*LAGS CORN*/
SSDCORN_1 = LAG(DCORN)*ECT5_1*ECT5_1;
SSDCORN_2 = LAG2(DCORN)*ECT5_1*ECT5_1;
SSDCORN_3 = LAG3(DCORN)*ECT5_1*ECT5_1;


/*LAGS ETHANOL*/
SSDETHANOL_1 = LAG(DETHANOL)*ECT5_1*ECT5_1;
SSDETHANOL_2 = LAG2(DETHANOL)*ECT5_1*ECT5_1;
SSDETHANOL_3 = LAG3(DETHANOL)*ECT5_1*ECT5_1;



/*LAGS OIL*/
SSDOIL_1 = LAG(DOIL)*ECT5_1*ECT5_1;
SSDOIL_2 = LAG2(DOIL)*ECT5_1*ECT5_1;
SSDOIL_3 = LAG3(DOIL)*ECT5_1*ECT5_1;



/*LAGS GASOLINE*/
SSDGASOLINE_1 = LAG(DGASOLINE)*ECT5_1*ECT5_1;
SSDGASOLINE_2 = LAG2(DGASOLINE)*ECT5_1*ECT5_1;
SSDGASOLINE_3 = LAG3(DGASOLINE)*ECT5_1*ECT5_1;



RUN;



/*TESTING FOR LINEARITY*/

/*ESTIMATING THE MODEL */

 PROC SYSLIN DATA=ALL2 SUR OUT=PRED; 
      E:      MODEL DETHANOL =   

ECT4_1 ECT5_1 
DETHANOL_1 DETHANOL_2 DETHANOL_3 
DCORN_1 DCORN_2 DCORN_3
DOIL_1 DOIL_2 DOIL_3
DGASOLINE_1 DGASOLINE_2 DGASOLINE_3

SECT4_1  SECT5_1 
SSECT4_1 SSECT5_1 

SDCORN_1 SDCORN_2 SDCORN_3
SDOIL_1 SDOIL_2 SDOIL_3
SDETHANOL_1 SDETHANOL_2 SDETHANOL_3 
SDGASOLINE_1 SDGASOLINE_2 SDGASOLINE_3

SSDCORN_1 SSDCORN_2 SSDCORN_3
SSDOIL_1 SSDOIL_2 SSDOIL_3
SSDETHANOL_1 SSDETHANOL_2 SSDETHANOL_3
SSDGASOLINE_1 SSDGASOLINE_2 SSDGASOLINE_3

; 
OUTPUT R=R_ETHANOL;


	C:      MODEL DCORN =   

ECT4_1 ECT5_1 
DETHANOL_1 DETHANOL_2 DETHANOL_3 
DCORN_1 DCORN_2 DCORN_3
DOIL_1 DOIL_2 DOIL_3
DGASOLINE_1 DGASOLINE_2 DGASOLINE_3

SECT4_1  SECT5_1 
SSECT4_1 SSECT5_1 

SDCORN_1 SDCORN_2 SDCORN_3
SDOIL_1 SDOIL_2 SDOIL_3
SDETHANOL_1 SDETHANOL_2 SDETHANOL_3 
SDGASOLINE_1 SDGASOLINE_2 SDGASOLINE_3

SSDCORN_1 SSDCORN_2 SSDCORN_3
SSDOIL_1 SSDOIL_2 SSDOIL_3
SSDETHANOL_1 SSDETHANOL_2 SSDETHANOL_3
SSDGASOLINE_1 SSDGASOLINE_2 SSDGASOLINE_3

; 
 OUTPUT R=R_CORN;


	O:      MODEL DOIL =   

ECT4_1 ECT5_1 
DETHANOL_1 DETHANOL_2 DETHANOL_3 
DCORN_1 DCORN_2 DCORN_3
DOIL_1 DOIL_2 DOIL_3
DGASOLINE_1 DGASOLINE_2 DGASOLINE_3

SECT4_1  SECT5_1 
SSECT4_1 SSECT5_1 

SDCORN_1 SDCORN_2 SDCORN_3
SDOIL_1 SDOIL_2 SDOIL_3
SDETHANOL_1 SDETHANOL_2 SDETHANOL_3 
SDGASOLINE_1 SDGASOLINE_2 SDGASOLINE_3

SSDCORN_1 SSDCORN_2 SSDCORN_3
SSDOIL_1 SSDOIL_2 SSDOIL_3
SSDETHANOL_1 SSDETHANOL_2 SSDETHANOL_3
SSDGASOLINE_1 SSDGASOLINE_2 SSDGASOLINE_3
; 
OUTPUT R=R_OIL;


	G:      MODEL DGASOLINE =   

ECT4_1 ECT5_1 
DETHANOL_1 DETHANOL_2 DETHANOL_3 
DCORN_1 DCORN_2 DCORN_3
DOIL_1 DOIL_2 DOIL_3
DGASOLINE_1 DGASOLINE_2 DGASOLINE_3

SECT4_1  SECT5_1 
SSECT4_1 SSECT5_1 

SDCORN_1 SDCORN_2 SDCORN_3
SDOIL_1 SDOIL_2 SDOIL_3
SDETHANOL_1 SDETHANOL_2 SDETHANOL_3 
SDGASOLINE_1 SDGASOLINE_2 SDGASOLINE_3

SSDCORN_1 SSDCORN_2 SSDCORN_3
SSDOIL_1 SSDOIL_2 SSDOIL_3
SSDETHANOL_1 SSDETHANOL_2 SSDETHANOL_3
SSDGASOLINE_1 SSDGASOLINE_2 SSDGASOLINE_3
; 
OUTPUT R=R_GASOLINE;




  RUN;
/*THE STEST IN PROC SYSLIN CAN THEN BE USED TO DERIVE THE TEST VALUE*/









/*************************************************************************************/



/**************************ESTIMATION OF THE STVECM**************************/

/*************************************************************************************/



  

 PROC MODEL DATA=ALL2_SPEC OUTPARMS=STARPARMS;

 PARM 

 GAMMA C1 
 M11 M12 M21 M22 M31 M32 M41 M42 /*CONSTANT - MIJ, WHERE I=EQUATION, J=REGIME*/
 L111 L112
 L121 L122 
 L211 L212 
 L221 L222  
 L311 L312  
 L321 L322 
 L411 L412 
 L421 L422  

 A1111 A1211 A1121 A1221 A1131 A1231 A1141 A1241  
 A1112 A1212 A1122 A1222 A1132 A1232 A1142 A1242  
 A1113 A1213 A1123 A1223 A1133 A1233 A1143 A1243  

 A2111 A2211 A2121 A2221 A2131 A2231 A2141 A2241  
 A2112 A2212 A2122 A2222 A2132 A2232 A2142 A2242  
 A2113 A2213 A2123 A2223 A2133 A2233 A2143 A2243  

 A3111 A3211 A3121 A3221 A3131 A3231 A3141 A3241  
 A3112 A3212 A3122 A3222 A3132 A3232 A3142 A3242  
 A3113 A3213 A3123 A3223 A3133 A3233 A3143 A3243  

 A4111 A4211 A4121 A4221 A4131 A4231 A4141 A4241  
 A4112 A4212 A4122 A4222 A4132 A4232 A4142 A4242  
 A4113 A4213 A4123 A4223 A4133 A4233 A4143 A4243  

 D1  
;

DETHANOL = 
(
M11
 
+ L111*ECT4_1 + L112*ECT5_1 
 
+ A1111*DETHANOL_1 + A1112*DETHANOL_2 + A1113*DETHANOL_3  
	  
+ A1121*DCORN_1 + A1122*DCORN_2 + A1123*DCORN_3   

+ A1131*DOIL_1 + A1132*DOIL_2 + A1133*DOIL_3    

+ A1141*DGASOLINE_1 + A1142*DGASOLINE_2 + A1143*DGASOLINE_3  

)*
(1-EXP(-GAMMA*(((ECT5_1-C1)**2)/VAR_ECT5)))

+

(
M12
 
+ L121*ECT4_1 + L122*ECT5_1 
 
+ A1211*DETHANOL_1 + A1212*DETHANOL_2 + A1213*DETHANOL_3  
	  
+ A1221*DCORN_1 + A1222*DCORN_2 + A1223*DCORN_3    

+ A1231*DOIL_1 + A1232*DOIL_2 + A1233*DOIL_3   

+ A1241*DGASOLINE_1 + A1242*DGASOLINE_2  + A1243*DGASOLINE_3  

)*
(EXP(-GAMMA*(((ECT5_1-C1)**2)/VAR_ECT5)))
+ D1*DUMMY
;




DCORN = 
(
M21
 
+ L211*ECT4_1 + L212*ECT5_1 
 
+ A2111*DETHANOL_1 + A2112*DETHANOL_2  + A2113*DETHANOL_3    
	  
+ A2121*DCORN_1 + A2122*DCORN_2 + A2123*DCORN_3   

+ A2131*DOIL_1 + A2132*DOIL_2 + A2133*DOIL_3   

+ A2141*DGASOLINE_1 + A2142*DGASOLINE_2 + A2143*DGASOLINE_3   

)*
(1-EXP(-GAMMA*(((ECT5_1-C1)**2)/VAR_ECT5)))

+

(
M22
 + L221*ECT4_1 + L222*ECT5_1 


+ A2211*DETHANOL_1 + A2212*DETHANOL_2 + A2213*DETHANOL_3  
	  
+ A2221*DCORN_1 + A2222*DCORN_2 + A2223*DCORN_3   

+ A2231*DOIL_1 + A2232*DOIL_2 + A2233*DOIL_3   

+ A2241*DGASOLINE_1 + A2242*DGASOLINE_2 + A2243*DGASOLINE_3   

)*
(EXP(-GAMMA*(((ECT5_1-C1)**2)/VAR_ECT5)))

;


DOIL = 
(
M31
 + L311*ECT4_1 + L312*ECT5_1 


+ A3111*DETHANOL_1 + A3112*DETHANOL_2  + A3113*DETHANOL_3    
	  
+ A3121*DCORN_1 + A3122*DCORN_2 + A3123*DCORN_3  

+ A3131*DOIL_1 + A3132*DOIL_2 + A3133*DOIL_3    

+ A3141*DGASOLINE_1 + A3142*DGASOLINE_2  + A3143*DGASOLINE_3  

)*
(1-EXP(-GAMMA*(((ECT5_1-C1)**2)/VAR_ECT5)))

+

(
M32
 
+ L321*ECT4_1 + L322*ECT5_1 
 
+ A3211*DETHANOL_1 + A3212*DETHANOL_2 + A3213*DETHANOL_3        
	  
+ A3221*DCORN_1 + A3222*DCORN_2 + A3223*DCORN_3   

+ A3231*DOIL_1 + A3232*DOIL_2  + A3233*DOIL_3  

+ A3241*DGASOLINE_1 + A3242*DGASOLINE_2 + A3243*DGASOLINE_3   


)*
(EXP(-GAMMA*(((ECT5_1-C1)**2)/VAR_ECT5)))

;


DGASOLINE = 
(
M41
 + L411*ECT4_1 + L412*ECT5_1 


+ A4111*DETHANOL_1 + A4112*DETHANOL_2 + A4113*DETHANOL_3   
	  
+ A4121*DCORN_1 + A4122*DCORN_2 + A4123*DCORN_3  

+ A4131*DOIL_1 + A4132*DOIL_2 + A4133*DOIL_3  

+ A4141*DGASOLINE_1 + A4142*DGASOLINE_2+ A4143*DGASOLINE_3    


)*
(1-EXP(-GAMMA*(((ECT5_1-C1)**2)/VAR_ECT5)))

+

(
M42
 
+ L421*ECT4_1 + L422*ECT5_1 
 
+ A4211*DETHANOL_1 + A4212*DETHANOL_2  + A4213*DETHANOL_3  
	  
+ A4221*DCORN_1 + A4222*DCORN_2 + A4223*DCORN_3    

+ A4231*DOIL_1 + A4232*DOIL_2 + A4233*DOIL_3   

+ A4241*DGASOLINE_1 + A4242*DGASOLINE_2 + A4243*DGASOLINE_3   

)*
(EXP(-GAMMA*(((ECT5_1-C1)**2)/VAR_ECT5)))

;





RESTRICT GAMMA>0;
  FIT DETHANOL DCORN DOIL DGASOLINE 
          START=(GAMMA 0.2 C1 0) / 
OLS OUT=RESID  OUTEST=EXPORT COVOUT NORMAL; RUN;




